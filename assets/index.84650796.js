import{a as ee}from"./components.40efc8e7.js";import{F as ae,u as le}from"./provide.410f5d3b.js";import{a as te}from"./elements.6395be39.js";import{t as V,d as s,i as re}from"./shared.506a394a.js";import{_ as ne}from"./elevation.7fcd6f98.js";import{d as ue,r as $,q as oe,b as y,y as H,x as se,e as ie,o as w,c as F,a as d,n as h,F as de,k as ce,G as me,p as L,i as ve,z as be,t as he}from"./vendor.4723551d.js";function fe(e){return["always","normal","never"].includes(e)}const Ve={modelValue:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:{type:Boolean,default:!1},labelVisible:{type:String,default:"normal",validator:fe},activeColor:{type:String},trackColor:{type:String},thumbColor:{type:String},labelColor:{type:String},labelTextColor:{type:String},trackHeight:{type:[String,Number]},thumbSize:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},rules:{type:Array},onChange:{type:Function},onStart:{type:Function},onEnd:{type:Function},"onUpdate:modelValue":{type:Function}};var q=(e=>(e.First="1",e.Second="2",e))(q||{});const ge=ue({name:"VarSlider",components:{VarFormDetails:ae},props:Ve,setup(e){const{bindForm:f,form:c}=le(),{errorMessage:D,validateWithTrigger:M,validate:p,resetValidation:k}=ee(),n=()=>p(e.rules,e.modelValue),i=()=>({startPosition:0,currentLeft:0,active:!1,percentValue:0}),G=()=>be(()=>M(["onChange"],"onChange",e.rules,e.modelValue)),T=$(null),m=$(0),z=$(!1),r=oe({["1"]:i(),["2"]:i()}),v=y(()=>m.value/100*V(e.step)),R=y(()=>{let a=[{value:e.modelValue,enumValue:"1"}];return e.range&&s(e.modelValue)&&(a=[{value:e.modelValue[0],enumValue:"1"},{value:e.modelValue[1],enumValue:"2"}]),a}),j=a=>e.labelVisible==="always"?!0:e.labelVisible==="never"?!1:r[a].active,J=y(()=>{const{activeColor:a,range:l,modelValue:t}=e,u=l&&s(t)?Math.abs(t[0]-t[1]):t,o=l&&s(t)?Math.min(t[0],t[1]):0;return{width:`${u}%`,left:`${o}%`,background:a}}),g=y(()=>e.disabled||(c==null?void 0:c.disabled.value)),N=y(()=>e.readonly||(c==null?void 0:c.readonly.value)),B=(a,l)=>{var X;let t=[];const{step:u,range:o,modelValue:b,onChange:C}=e,U=V(u),S=Math.round(a/v.value)*U,x=r[l].percentValue;if(r[l].percentValue=S/U,o&&s(b)&&(t=l==="1"?[S,b[1]]:[b[0],S]),x!==S){const _=o?t:S;C==null||C(_),(X=e["onUpdate:modelValue"])==null||X.call(e,_),G()}},K=a=>{if(!e.range)return"1";const l=r["1"].percentValue*v.value,t=r["2"].percentValue*v.value,u=Math.abs(a-l),o=Math.abs(a-t);return u<=o?"1":"2"},O=(a,l)=>{var t;m.value||(m.value=T.value.offsetWidth),!(g.value||N.value)&&((t=e.onStart)==null||t.call(e),z.value=!0,r[l].startPosition=a.touches[0].clientX)},Q=(a,l)=>{if(g.value||N.value||!z.value)return;let t=a.touches[0].clientX-r[l].startPosition+r[l].currentLeft;r[l].active=!0,t<=0?t=0:t>=m.value&&(t=m.value),B(t,l)},W=a=>{const{range:l,modelValue:t,onEnd:u}=e;if(g.value||N.value)return;let o=[];r[a].currentLeft=r[a].percentValue*v.value,r[a].active=!1;const b=r[a].percentValue;l&&s(t)&&(o=a==="1"?[b,t[1]]:[t[0],b]),u==null||u(l?o:b),z.value=!1},Y=a=>{if(g.value||N.value||a.target.closest(".var-slider__thumb"))return;const l=a.clientX-te(a.currentTarget),t=K(l);B(l,t),W(t)},A=()=>{const a=V(e.step);return isNaN(a)?(console.warn('[Varlet] Slider: type of prop "step" should be Number'),!1):a<1||a>100?(console.warn('[Varlet] Slider: "step" should be >= 0 and <= 100'),!1):parseInt(`${e.step}`,10)!==a?(console.warn('[Varlet] Slider: "step" should be an Integer'),!1):!0},E=()=>{const{range:a,modelValue:l}=e;return a&&!s(l)?(console.error('[Varlet] Slider: "modelValue" should be an Array'),!1):!a&&s(l)?(console.error('[Varlet] Slider: "modelValue" should be a Number'),!1):a&&s(l)&&l.length<2?(console.error('[Varlet] Slider: "modelValue" should have two value'),!1):!0},I=(a=e.modelValue,l=V(e.step))=>{e.range&&s(a)?(r["1"].percentValue=a[0]/l,r["1"].currentLeft=r["1"].percentValue*v.value,r["2"].percentValue=a[1]/l,r["2"].currentLeft=r["2"].percentValue*v.value):re(a)&&(r["1"].currentLeft=a/l*v.value)};H([()=>e.modelValue,()=>e.step],([a,l])=>{!A()||!E()||z.value||I(a,V(l))}),H(m,()=>I()),se(()=>{!A()||!E()||(m.value=T.value.offsetWidth)});const Z={reset:()=>{var l;const a=e.range?[0,0]:0;(l=e["onUpdate:modelValue"])==null||l.call(e,a),k()},validate:n,resetValidation:k};return f==null||f(Z),{Thumbs:q,sliderEl:T,getFillStyle:J,isDisabled:g,errorMessage:D,thumbsProps:r,thumbList:R,toNumber:V,showLabel:j,start:O,move:Q,end:W,click:Y}}}),Se={class:"var-slider"},ye={class:"var-slider__track"},ke=["onTouchstart","onTouchmove","onTouchend","onTouchcancel"];function ze(e,f,c,D,M,p){const k=ie("var-form-details");return w(),F("div",Se,[d("div",{class:L(["var-slider-block",[e.isDisabled?"var-slider__disable":null,e.errorMessage?"var-slider__error":null]]),style:h({height:e.thumbSize===void 0?e.thumbSize:`${3*e.toNumber(e.thumbSize)}px`,margin:e.thumbSize===void 0?e.thumbSize:`0 ${e.toNumber(e.thumbSize)/2}px`}),ref:"sliderEl",onClick:f[0]||(f[0]=(...n)=>e.click&&e.click(...n))},[d("div",ye,[d("div",{class:"var-slider__track-background",style:h({background:e.trackColor,height:e.trackHeight+"px"})},null,4),d("div",{class:"var-slider__track-fill",style:h(e.getFillStyle)},null,4)]),(w(!0),F(de,null,ce(e.thumbList,n=>(w(),F("div",{class:"var-slider__thumb",key:n.enumValue,style:h({left:`${n.value}%`,zIndex:e.thumbsProps[n.enumValue].active?1:void 0}),onTouchstart:i=>e.start(i,n.enumValue),onTouchmove:i=>e.move(i,n.enumValue),onTouchend:i=>e.end(n.enumValue),onTouchcancel:i=>e.end(n.enumValue)},[me(e.$slots,"button",{currentValue:n.value},()=>[d("div",{class:"var-slider__thumb-block",style:h({background:e.thumbColor,height:e.thumbSize+"px",width:e.thumbSize+"px"})},null,4),d("div",{class:L(["var-slider__thumb-ripple",[e.thumbsProps[n.enumValue].active?"var-slider__thumb-ripple-active":null]]),style:h({background:e.thumbColor,height:e.thumbSize===void 0?void 0:e.thumbsProps[n.enumValue].active?`${3*e.toNumber(e.thumbSize)}px`:"0px",width:e.thumbSize===void 0?void 0:e.thumbsProps[n.enumValue].active?`${3*e.toNumber(e.thumbSize)}px`:"0px"})},null,6),d("div",{class:L(["var-slider__thumb-label",[e.showLabel(n.enumValue)?"var-slider__thumb-label-active":null]]),style:h({background:e.labelColor,color:e.labelTextColor,height:e.thumbSize===void 0?e.thumbSize:`${2*e.toNumber(e.thumbSize)}px`,width:e.thumbSize===void 0?e.thumbSize:`${2*e.toNumber(e.thumbSize)}px`})},[d("span",null,he(n.value),1)],6)])],44,ke))),128))],6),ve(k,{"error-message":e.errorMessage,class:"var-slider__form","var-slider-cover":""},null,8,["error-message"])])}var P=ne(ge,[["render",ze]]);P.install=function(e){e.component(P.name,P)};export{P as S};
