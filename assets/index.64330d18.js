import{I as ve}from"./index.8b4cefd8.js";import{M as fe}from"./index.ecb4c0fe.js";import{C as me}from"./index.247d96bc.js";import{F as ye,u as be}from"./provide.aed138f2.js";import{d as he,r as p,b as E,y as $,e as S,o as u,c as m,a as c,p as i,G as N,i as U,j as W,n as V,F as pe,k as ge,l as Q,m as Ce,t as B,R as Ve,h as X,z as Fe}from"./vendor.49f89f0d.js";import{b as D,d as we}from"./shared.506a394a.js";import{a as ke}from"./components.721843ff.js";import{u as Me}from"./index.d73ecdc7.js";import{b as Y}from"./elements.92736b4e.js";import{_ as Se}from"./elevation.ef1405ab.js";function Be(e){return["left","right","center"].includes(e)}const De={modelValue:{default:void 0},placeholder:{type:String},multiple:{type:Boolean,default:!1},offsetY:{type:[String,Number],default:0},chip:{type:Boolean,default:!1},line:{type:Boolean,default:!0},hint:{type:Boolean,default:!0},textColor:{type:String},focusColor:{type:String},blurColor:{type:String},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},separator:{type:String,default:","},textAlign:{type:String,default:"left",validator:Be},validateTrigger:{type:Array,default:()=>["onChange","onClear","onClose"]},rules:{type:Array},onFocus:{type:Function},onBlur:{type:Function},onClick:{type:Function},onClear:{type:Function},onClose:{type:Function},onChange:{type:Function},"onUpdate:modelValue":{type:Function}};const Te=he({name:"VarSelect",components:{VarIcon:ve,VarMenu:fe,VarChip:me,VarFormDetails:ye},props:De,setup(e){const n=p(null),v=p(!1),O=E(()=>e.multiple),L=E(()=>e.focusColor),F=p(""),w=p([]),y=p("0px"),g=p(0),{bindForm:C,form:l}=be(),{length:Z,options:b,bindOptions:_}=Me(),{errorMessage:x,validateWithTrigger:ee,validate:le,resetValidation:T}=ke(),ae=()=>{const{multiple:a,modelValue:s}=e;if(a){const o=s;w.value=o.map(P)}!a&&!D(s)&&(F.value=P(s)),!a&&D(s)&&(F.value="")},h=a=>{Fe(()=>{const{validateTrigger:s,rules:o,modelValue:t}=e;ee(s,a,o,t)})},k=({value:a,label:s})=>a.value!=null?a.value:s.value,P=a=>{let s=b.find(({value:o})=>o.value===a);return s||(s=b.find(({label:o})=>o.value===a)),s.label.value},se=()=>{const{hint:a,modelValue:s}=e;if(!a&&!D(s))return"var-select--placeholder-hidden";if(a&&(!D(s)||v.value))return"var-select--placeholder-hint"},I=()=>n.value&&window.getComputedStyle(n.value).width||"0px",j=()=>{const a=n.value&&window.getComputedStyle(n.value).paddingTop||"0px";return Y(a)*1.5},oe=()=>{const{disabled:a,readonly:s,onFocus:o}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||s||(y.value=I(),g.value=j()+Y(e.offsetY),v.value=!0,o==null||o(),h("onFocus"))},ne=()=>{const{disabled:a,readonly:s,onBlur:o}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||s||(o==null||o(),h("onBlur"))},te=a=>{var d;const{disabled:s,readonly:o,multiple:t,onChange:r}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||o)return;const f=t?b.filter(({selected:M})=>M.value).map(k):k(a);(d=e["onUpdate:modelValue"])==null||d.call(e,f),r==null||r(f),h("onChange"),!t&&(v.value=!1)},re=()=>{var d;const{disabled:a,readonly:s,multiple:o,clearable:t,onClear:r}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||s||!t)return;const f=o?[]:void 0;(d=e["onUpdate:modelValue"])==null||d.call(e,f),r==null||r(f),h("onClear")},ie=a=>{const{disabled:s,onClick:o}=e;(l==null?void 0:l.disabled.value)||s||(o==null||o(a),h("onClick"))},ue=a=>{var J;const{disabled:s,readonly:o,modelValue:t,onClose:r}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||o)return;const f=t,d=b.find(({label:A})=>A.value===a),M=f.filter(A=>{var K;return A!==((K=d.value.value)!=null?K:d.label.value)});(J=e["onUpdate:modelValue"])==null||J.call(e,M),r==null||r(M),h("onClose")},G=()=>{const{multiple:a,modelValue:s}=e;if(a){const o=s;b.forEach(t=>t.sync(o.includes(k(t))))}else b.forEach(o=>o.sync(s===k(o)));ae()},de=()=>{y.value=I(),g.value=j()+Y(e.offsetY),v.value=!0},ce=()=>{v.value=!1},R=()=>le(e.rules,e.modelValue),q=()=>{var a;(a=e["onUpdate:modelValue"])==null||a.call(e,e.multiple?[]:void 0),T()};$(()=>e.multiple,()=>{const{multiple:a,modelValue:s}=e;if(a&&!we(s))throw Error("The modelValue must be an array when multiple is true")}),$(()=>e.modelValue,G,{deep:!0}),$(()=>Z.value,G);const H={wrapWidth:E(()=>y.value),multiple:O,focusColor:L,onSelect:te,reset:q,validate:R,resetValidation:T};return _(H),C==null||C(H),{wrapEl:n,offsetY:g,isFocus:v,errorMessage:x,formDisabled:l==null?void 0:l.disabled,label:F,labels:w,computePlaceholderState:se,handleFocus:oe,handleBlur:ne,handleClear:re,handleClick:ie,handleClose:ue,reset:q,validate:R,resetValidation:T,focus:de,blur:ce}}}),Ae={key:0},Ee={key:0,class:"var-select__chips"},$e={key:1,class:"var-select__values"},Ne={key:1},Ue={class:"var-select__scroller"};function We(e,n,v,O,L,F){const w=S("var-chip"),y=S("var-icon"),g=S("var-menu"),C=S("var-form-details");return u(),m("div",{class:i(["var-select var--box",[e.formDisabled||e.disabled?"var-select--disabled":null]]),onClick:n[3]||(n[3]=(...l)=>e.handleClick&&e.handleClick(...l))},[c("div",{class:i(["var-select__controller",[e.isFocus?"var-select--focus":null,e.errorMessage?"var-select--error":null,e.formDisabled||e.disabled?"var-select--disabled":null]]),style:V({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},[c("div",{class:i(["var-select__icon",[e.hint?null:"var-select--non-hint"]])},[N(e.$slots,"prepend-icon")],2),U(g,{class:"var-select__menu","var-select-cover":"","offset-y":e.offsetY,show:e.isFocus,"onUpdate:show":n[2]||(n[2]=l=>e.isFocus=l),onClose:e.handleBlur},{menu:W(()=>[c("div",Ue,[N(e.$slots,"default")])]),default:W(()=>[c("div",{class:i(["var-select__wrap",[e.hint?null:"var-select--non-hint"]]),ref:"wrapEl",onClick:n[1]||(n[1]=(...l)=>e.handleFocus&&e.handleFocus(...l))},[c("div",{class:i(["var-select__select",[e.errorMessage?"var-select--error":null,e.formDisabled||e.disabled?"var-select--disabled":null]]),style:V({textAlign:e.textAlign,color:e.textColor})},[e.multiple?(u(),m("div",Ae,[e.chip?(u(),m("div",Ee,[(u(!0),m(pe,null,ge(e.labels,l=>(u(),Q(w,{class:"var-select__chip","var-select-cover":"",closable:"",size:"small",type:e.errorMessage?"danger":void 0,key:l,onClick:n[0]||(n[0]=Ve(()=>{},["stop"])),onClose:()=>e.handleClose(l)},{default:W(()=>[Ce(B(l),1)]),_:2},1032,["type","onClose"]))),128))])):(u(),m("div",$e,B(e.labels.join(e.separator)),1))])):(u(),m("span",Ne,B(e.label),1)),U(y,{class:i(["var-select__arrow",[e.isFocus?"var-select--arrow-rotate":null]]),"var-select-cover":"",name:"menu-down",transition:300},null,8,["class"])],6),c("label",{class:i(["var-select__placeholder var--ellipsis",[e.isFocus?"var-select--focus":null,e.errorMessage?"var-select--error":null,e.formDisabled||e.disabled?"var-select--disabled":null,e.computePlaceholderState(),e.hint?null:"var-select--placeholder-non-hint"]]),style:V({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},B(e.placeholder),7)],2)]),_:3},8,["offset-y","show","onClose"]),c("div",{class:i(["var-select__icon",[e.hint?null:"var-select--non-hint"]])},[N(e.$slots,"append-icon",{},()=>[e.clearable?(u(),Q(y,{key:0,class:"var-select__clear-icon",name:"close-circle",size:"14px",onClick:e.handleClear},null,8,["onClick"])):X("v-if",!0)])],2)],6),e.line?(u(),m("div",{key:0,class:i(["var-select__line",[e.formDisabled||e.disabled?"var-select--line-disabled":null,e.errorMessage?"var-select--line-error":null]]),style:V({background:e.errorMessage?void 0:e.blurColor})},[c("div",{class:i(["var-select__dot",[e.isFocus?"var-select--spread":null,e.formDisabled||e.disabled?"var-select--line-disabled":null,e.errorMessage?"var-select--line-error":null]]),style:V({background:e.errorMessage?void 0:e.focusColor})},null,6)],6)):X("v-if",!0),U(C,{"error-message":e.errorMessage},null,8,["error-message"])],2)}var z=Se(Te,[["render",We]]);z.install=function(e){e.component(z.name,z)};export{z as S};
