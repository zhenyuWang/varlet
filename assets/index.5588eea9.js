import{I as pe}from"./index.e30cf35b.js";import{M as fe}from"./index.44744767.js";import{C as me}from"./index.48655421.js";import{F as be,u as ye}from"./provide.538f2bd7.js";import{d as he,r as y,b as E,y as N,e as M,o as d,c as p,a as u,p as n,G as $,i as z,j as U,n as g,F as Ce,k as ge,l as X,m as Ve,t as S,R as Fe,h as Z,z as ke}from"./vendor.49f89f0d.js";import{d as we,a as t,c as Me,f as B,z as Se}from"./components.5cba9644.js";import{u as Be}from"./index.3ae81bfe.js";import{b as W}from"./elements.b75de382.js";import{_ as De}from"./elevation.4d11ec3f.js";function Te(e){return["left","right","center"].includes(e)}const Ae={modelValue:{default:void 0},placeholder:{type:String},multiple:{type:Boolean,default:!1},offsetY:{type:[String,Number],default:0},chip:{type:Boolean,default:!1},line:{type:Boolean,default:!0},hint:{type:Boolean,default:!0},textColor:{type:String},focusColor:{type:String},blurColor:{type:String},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},separator:{type:String,default:","},textAlign:{type:String,default:"left",validator:Te},validateTrigger:{type:Array,default:()=>["onChange","onClear","onClose"]},rules:{type:Array},onFocus:{type:Function},onBlur:{type:Function},onClick:{type:Function},onClear:{type:Function},onClose:{type:Function},onChange:{type:Function},"onUpdate:modelValue":{type:Function}};const{n:Y,classes:Ee}=Me("select"),Ne=he({name:"VarSelect",components:{VarIcon:pe,VarMenu:fe,VarChip:me,VarFormDetails:be},props:Ae,setup(e){const r=y(null),c=y(!1),L=E(()=>e.multiple),P=E(()=>e.focusColor),V=y(""),F=y([]),f=y("0px"),h=y(0),{bindForm:D,form:l}=ye(),{length:_,options:m,bindOptions:x}=Be(),{errorMessage:ee,validateWithTrigger:le,validate:ae,resetValidation:T}=we(),se=()=>{const{multiple:a,modelValue:s}=e;if(a){const o=s;F.value=o.map(I)}!a&&!B(s)&&(V.value=I(s)),!a&&B(s)&&(V.value="")},b=a=>{ke(()=>{const{validateTrigger:s,rules:o,modelValue:i}=e;le(s,a,o,i)})},k=({value:a,label:s})=>a.value!=null?a.value:s.value,I=a=>{let s=m.find(({value:o})=>o.value===a);return s||(s=m.find(({label:o})=>o.value===a)),s.label.value},oe=()=>{const{hint:a,modelValue:s}=e;if(!a&&!B(s))return Y("--placeholder-hidden");if(a&&(!B(s)||c.value))return Y("--placeholder-hint")},j=()=>r.value&&window.getComputedStyle(r.value).width||"0px",G=()=>{const a=r.value&&window.getComputedStyle(r.value).paddingTop||"0px";return W(a)*1.5},ne=()=>{const{disabled:a,readonly:s,onFocus:o}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||s||(f.value=j(),h.value=G()+W(e.offsetY),c.value=!0,t(o),b("onFocus"))},re=()=>{const{disabled:a,readonly:s,onBlur:o}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||s||(t(o),b("onBlur"))},ie=a=>{const{disabled:s,readonly:o,multiple:i,onChange:C}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||o)return;const v=i?m.filter(({selected:w})=>w.value).map(k):k(a);t(e["onUpdate:modelValue"],v),t(C,v),b("onChange"),!i&&(c.value=!1)},te=()=>{const{disabled:a,readonly:s,multiple:o,clearable:i,onClear:C}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||s||!i)return;const v=o?[]:void 0;t(e["onUpdate:modelValue"],v),t(C,v),b("onClear")},de=a=>{const{disabled:s,onClick:o}=e;(l==null?void 0:l.disabled.value)||s||(t(o,a),b("onClick"))},ue=a=>{const{disabled:s,readonly:o,modelValue:i,onClose:C}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||o)return;const v=i,w=m.find(({label:A})=>A.value===a),K=v.filter(A=>{var Q;return A!==((Q=w.value.value)!=null?Q:w.label.value)});t(e["onUpdate:modelValue"],K),t(C,K),b("onClose")},R=()=>{const{multiple:a,modelValue:s}=e;if(a){const o=s;m.forEach(i=>i.sync(o.includes(k(i))))}else m.forEach(o=>o.sync(s===k(o)));se()},ce=()=>{f.value=j(),h.value=G()+W(e.offsetY),c.value=!0},ve=()=>{c.value=!1},q=()=>ae(e.rules,e.modelValue),H=()=>{t(e["onUpdate:modelValue"],e.multiple?[]:void 0),T()};N(()=>e.multiple,()=>{const{multiple:a,modelValue:s}=e;if(a&&!Se(s))throw Error("The modelValue must be an array when multiple is true")}),N(()=>e.modelValue,R,{deep:!0}),N(()=>_.value,R);const J={wrapWidth:E(()=>f.value),multiple:L,focusColor:P,onSelect:ie,reset:H,validate:q,resetValidation:T};return x(J),t(D,J),{wrapEl:r,offsetY:h,isFocus:c,errorMessage:ee,formDisabled:l==null?void 0:l.disabled,label:V,labels:F,n:Y,classes:Ee,computePlaceholderState:oe,handleFocus:ne,handleBlur:re,handleClear:te,handleClick:de,handleClose:ue,reset:H,validate:q,resetValidation:T,focus:ce,blur:ve}}}),$e={key:0},ze={key:1};function Ue(e,r,c,L,P,V){const F=M("var-chip"),f=M("var-icon"),h=M("var-menu"),D=M("var-form-details");return d(),p("div",{class:n(e.classes(e.n(),"var--box",[e.formDisabled||e.disabled,e.n("--disabled")])),onClick:r[3]||(r[3]=(...l)=>e.handleClick&&e.handleClick(...l))},[u("div",{class:n(e.classes(e.n("controller"),[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:g({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},[u("div",{class:n(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[$(e.$slots,"prepend-icon")],2),z(h,{class:n(e.n("menu")),"var-select-cover":"","offset-y":e.offsetY,show:e.isFocus,"onUpdate:show":r[2]||(r[2]=l=>e.isFocus=l),onClose:e.handleBlur},{menu:U(()=>[u("div",{class:n(e.n("scroller"))},[$(e.$slots,"default")],2)]),default:U(()=>[u("div",{class:n(e.classes(e.n("wrap"),[!e.hint,e.n("--non-hint")])),ref:"wrapEl",onClick:r[1]||(r[1]=(...l)=>e.handleFocus&&e.handleFocus(...l))},[u("div",{class:n(e.classes(e.n("select"),[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:g({textAlign:e.textAlign,color:e.textColor})},[e.multiple?(d(),p("div",$e,[e.chip?(d(),p("div",{key:0,class:n(e.n("chips"))},[(d(!0),p(Ce,null,ge(e.labels,l=>(d(),X(F,{class:n(e.n("chip")),"var-select-cover":"",closable:"",size:"small",type:e.errorMessage?"danger":void 0,key:l,onClick:r[0]||(r[0]=Fe(()=>{},["stop"])),onClose:()=>e.handleClose(l)},{default:U(()=>[Ve(S(l),1)]),_:2},1032,["class","type","onClose"]))),128))],2)):(d(),p("div",{key:1,class:n(e.n("values"))},S(e.labels.join(e.separator)),3))])):(d(),p("span",ze,S(e.label),1)),z(f,{class:n(e.classes(e.n("arrow"),[e.isFocus,e.n("--arrow-rotate")])),"var-select-cover":"",name:"menu-down",transition:300},null,8,["class"])],6),u("label",{class:n(e.classes(e.n("placeholder"),"var--ellipsis",[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")],e.computePlaceholderState(),[!e.hint,e.n("--placeholder-non-hint")])),style:g({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},S(e.placeholder),7)],2)]),_:3},8,["class","offset-y","show","onClose"]),u("div",{class:n(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[$(e.$slots,"append-icon",{},()=>[e.clearable?(d(),X(f,{key:0,class:n(e.n("clear-icon")),name:"close-circle",size:"14px",onClick:e.handleClear},null,8,["class","onClick"])):Z("v-if",!0)])],2)],6),e.line?(d(),p("div",{key:0,class:n(e.classes(e.n("line"),[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:g({background:e.errorMessage?void 0:e.blurColor})},[u("div",{class:n(e.classes(e.n("dot"),[e.isFocus,e.n("--spread")],[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:g({background:e.errorMessage?void 0:e.focusColor})},null,6)],6)):Z("v-if",!0),z(D,{"error-message":e.errorMessage},null,8,["error-message"])],2)}var O=De(Ne,[["render",Ue]]);O.install=function(e){e.component(O.name,O)};export{O as S};
